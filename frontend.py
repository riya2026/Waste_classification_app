import streamlit as st
from PIL import Image
#from onnx_yolo_wrapper import YOLO
import cv2
import numpy
import matplotlib.pyplot as plt
from fpdf import FPDF
import io
import os
import requests
import numpy as np

st.set_page_config(page_title="Image Input App", layout="centered")

language = st.selectbox("üåê Choose Language / ‡ÆÆ‡Øä‡Æ¥‡Æø‡ÆØ‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç / Pilih Bahasa", ["English", "Tamil", "Malay"])

class_names = ["apple", "banana", "plastic", "glass"]  # Add your real class list here
#model = YOLO("best.onnx", class_names)



def predict_image_class(image, model):
    image = image.convert('RGB')
    img = np.array(image)
    img_resized = cv2.resize(img, (256, 256))
    img_normalized = img_resized / 255.0
    img_reshaped = img_normalized.reshape(1, 256, 256, 3)

    prediction = model.predict(img_reshaped)
    predicted_index = np.argmax(prediction)
    predicted_class = class_names[predicted_index]
    return predicted_class


if language == "English":
    st.title("Waste Classification App - Keep Environment Clean")

    

    def predict_image_class(image, model):
        image = image.convert('RGB')
        img = np.array(image)
        img_resized = cv2.resize(img, (256, 256))
        img_normalized = img_resized / 255.0
        img_reshaped = img_normalized.reshape(1, 256, 256, 3)
        prediction = model.predict(img_reshaped)
        predicted_index = np.argmax(prediction)
        predicted_class = class_names[predicted_index]
        return predicted_class

    with st.sidebar:
        st.subheader('What is Biodegradable material?')
        st.write('Biodegradable material is any substance that can be broken down into natural elements like water, carbon dioxide, and biomass by living organisms over time without harming the environment. Example: Apple, Bananas, etc')
        st.subheader('What is Non-biodegradable material?')
        st.write('Non-biodegradable material is any substance that cannot be decomposed naturally by microorganisms and remains in the environment for a very long time. Example: Plastic bags, plastic bottles, glass, etc')
        st.subheader('What is CNN')
        st.write('A class of deep neural networks commonly used in computer vision that automatically and adaptively learns spatial hierarchies of features through convolutional layers.')
        st.subheader('What is Machine learning?')
        st.write('A branch of artificial intelligence that uses statistical techniques to give computers the ability to learn from data without being explicitly programmed.')
        st.subheader('What is streamlit?')
        st.write('A Python framework that turns data scripts into interactive web applications with minimal code, supporting widgets, charts, and real-time updates.')
        st.subheader('What is YOLOv8?')
        st.write('YOLOv8 is a computer program that can see and detect objects in images or videos ‚Äî like bananas, bottles, or people. YOLO stands for You Only Look Once, which means it looks at the image just one time and quickly finds all the objects.')

    a, b = st.tabs(['Home', 'Detection and report'])

    with b:
        st.title("üì∑ Image Input App")
        st.markdown("""
        **Choose how you'd like to provide an image:**
        - **Upload Image** to select from your device.
        - **Take Photo** to capture with your webcam.
        """)

        if 'mode' not in st.session_state:
            st.session_state.mode = None
        if 'image' not in st.session_state:
            st.session_state.image = None

        col1, col2 = st.columns(2)
        with col1:
            if st.button("Upload Image üìÅ"):
                st.session_state.mode = 'upload'
        with col2:
            if st.button("Take Photo üì∑"):
                st.session_state.mode = 'capture'

        if st.session_state.mode == 'upload':
            uploaded_file = st.file_uploader("Choose an image file", type=["png", "jpg", "jpeg"])
            if uploaded_file is not None:
                st.session_state.image = Image.open(uploaded_file)
        elif st.session_state.mode == 'capture':
            camera_image = st.camera_input("Take a picture")
            if camera_image is not None:
                st.session_state.image = Image.open(camera_image)

        if st.session_state.image is not None:
            st.subheader("Selected Image")
            st.image(st.session_state.image, caption="Here is the image you provided", use_container_width=True)

            if st.button("üîç Detect Objects"):
            
                st.subheader("YOLOv8 Detection Results")
                image_bytes = io.BytesIO()
                image_rgb = st.session_state.image.convert("RGB")
                image_rgb.save(image_bytes, format='JPEG')

                image_bytes.seek(0)
                
                # Send to FastAPI
                response = requests.post(
                    "https://fast-api-backend-8g48.onrender.com/predict",  # Change this to your deployed URL on Streamlit Cloud or public host
                    files={"file": ("image.jpg", image_bytes, "image/jpeg")},
                )
                boxes=[]
                if response.status_code == 200:
                    result = response.json()
                    boxes = result.get("results", [])
                    
                    # Draw boxes on the image
                    img = np.array(st.session_state.image.convert("RGB"))
                    for box in boxes:
                        x1, y1, x2, y2 = map(int, [box["x1"], box["y1"], box["x2"], box["y2"]])
                        label = box["label"]
                        conf = float(box["confidence"])
                        cv2.rectangle(img, (x1, y1), (x2, y2), (0, 255, 0), 2)
                        cv2.putText(img, f"{label} {conf:.2%}", (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.6, (255, 255, 255), 2)
                
                    st.image(img, caption="Detected Objects", use_container_width=True)
                
                    # Continue with biodegradable / non-biodegradable logic using `boxes`
                    # ‚¨Ö Your logic continues here...
                
                else:
                    st.error(f"‚ùå Error from detection server: {response.status_code}")
                    st.text(response.text)

                #st.image(result_img, caption="Detected Objects", use_container_width=True)
            
                biodegradable = {'apple', 'banana'}
                non_biodegradable = {'plastic', 'glass'}
                
                detected_labels = set()
                confidence_map = {}
                
                if boxes:
                    for box in boxes:
                        label = box["label"]
                        conf = float(box["confidence"])
                
                        detected_labels.add(label)
                        confidence_map[label] = f"{conf:.2%}"

            
                    st.subheader("‚ôªÔ∏è Waste Type Classification")
                    waste_type = None
                    if detected_labels & biodegradable and not detected_labels & non_biodegradable:
                        st.success("This waste is **Biodegradable**.")
                        st.audio("biodegradable.mp3", format="audio/mp3")
                        waste_type = "Biodegradable"
                    elif detected_labels & non_biodegradable and not detected_labels & biodegradable:
                        st.error("This waste is **Non-Biodegradable**.")
                        st.audio("non-biodegradable.mp3", format="audio/mp3")
                        waste_type = "Non-Biodegradable"
                    elif detected_labels & biodegradable and detected_labels & non_biodegradable:
                        st.info("This waste contains **both Biodegradable and Non-Biodegradable** materials.")
                        waste_type = "Mixed"
                    else:
                        st.warning("No recognizable waste type found.")

                    

                    # PDF Generation
                    if waste_type in ["Biodegradable", "Non-Biodegradable"]:
                        pdf = FPDF()
                        pdf.add_page()
                        pdf.set_font("Arial", size=12)

                        pdf.set_title("Waste Detection Report")
                        pdf.cell(200, 10, txt="Waste Detection Report", ln=True, align='C')
                        pdf.ln(10)

                        pdf.cell(200, 10, txt=f"Waste Type Detected: {waste_type}", ln=True)
                        pdf.ln(5)

                        

                        if waste_type == "Biodegradable":
                            pdf.multi_cell(0, 10, txt=(
                                "The CNN model based on deep learning accuracy: 90%\n"
                                "Yolov8 model accuracy: about 85%\n"
                                "Biodegradable waste such as apple and banana can naturally decompose.\n\n"
                                " Disposal Recommendation:\n"
                                "- Discard in green bins.\n"
                                "- Compost at home if possible.\n"
                                "- Do not mix with plastic or glass waste.\n\n"
                                " Environmental Measures:\n"
                                "- Promote organic composting.\n"
                                "- Keep surroundings clean.\n"
                                "- Educate others on separating biodegradable waste."
                            ))
                        else:
                            pdf.multi_cell(0, 10, txt=(
                                "The CNN model based on deep learning accuracy: 90%\n"
                                "Yolov8 model accuracy: about 85%\n"
                                "Non-biodegradable waste such as plastic and glass cannot decompose naturally.\n\n"
                                " Disposal Recommendation:\n"
                                "- Discard in blue bins or recycling centers.\n"
                                "- Never burn plastic waste.\n\n"
                                " Environmental Measures:\n"
                                "- Reduce plastic usage.\n"
                                "- Support recycling initiatives.\n"
                                "- Keep public areas free of litter."
                            ))

                        pdf_output = io.BytesIO()
                        pdf_bytes = pdf.output(dest='S').encode('latin-1')
                        pdf_output.write(pdf_bytes)
                        pdf_output.seek(0)

                        st.download_button(
                            label="üìÑ Download Waste Report as PDF",
                            data=pdf_output,
                            file_name="waste_report.pdf",
                            mime="application/pdf"
                        )

        st.divider()

    with a:
        st.write("## üåç Why It Matters")
        st.write("Every day, we generate tons of waste. Unfortunately, much of it ends up in the wrong places, harming our planet. Proper waste segregation is key to:")
        st.write("- Reducing environmental pollution")  
        st.write("- Enhancing recycling efficiency")  
        st.write("- Promoting a cleaner and greener future")
        st.write("Our system is designed to **distinguish between biodegradable and non-biodegradable items**, making waste disposal smarter and more sustainable.")
        st.write('---')
        st.write('#### Just capture or upload an image ‚Äî and let the system do the rest!')
        st.write('---')
        st.write("### üß† How It Works")
        st.write("Using machine learning and image processing, our model analyzes images of waste and classifies them into two main categories:")
        st.markdown("- **Biodegradable** ‚Äì Natural waste like fruits (apple, banana), leaves, etc.")
        st.markdown("- **Non-Biodegradable** ‚Äì Artificial waste like plastic bottles, wrappers, etc.")



if language == "Tamil":
    st.title("‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ ‡Æµ‡Æï‡Øà‡Æ™‡Øç‡Æ™‡Ææ‡Æü‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Æø - ‡Æö‡ØÅ‡Æ±‡Øç‡Æ±‡ØÅ‡Æö‡Øç‡Æö‡ØÇ‡Æ¥‡Æ≤‡Øà ‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Ææ‡Æï ‡Æµ‡Øà‡Æ§‡Øç‡Æ§‡Æø‡Æ∞‡ØÅ‡Æô‡Øç‡Æï‡Æ≥‡Øç")

    def predict_image_class(image, model):
        image = image.convert('RGB')
        img = np.array(image)
        img_resized = cv2.resize(img, (256, 256))
        img_normalized = img_resized / 255.0
        img_reshaped = img_normalized.reshape(1, 256, 256, 3)
        prediction = model.predict(img_reshaped)
        predicted_index = np.argmax(prediction)
        predicted_class = class_names[predicted_index]
        return predicted_class

    with st.sidebar:
        st.subheader('‡Æé‡Æ©‡Øç‡Æ© ‡Æá‡Æ§‡ØÅ ‚Äì ‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡ØÅ‡Æö‡Øç‡Æö‡Øá‡Æ∞‡Æø‡ÆØ‡Æï‡Øç‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ?')
        st.write('‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡ØÅ‡Æö‡Øç‡Æö‡Øá‡Æ∞‡Æø‡ÆØ‡Æï‡Øç‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡ØÅ ‡Æá‡ÆØ‡Æ±‡Øç‡Æï‡Øà‡ÆØ‡Ææ‡Æ≤‡Øç (‡Æ®‡ØÅ‡Æ£‡Øç‡Æ£‡ØÅ‡ÆØ‡Æø‡Æ∞‡Æø‡Æï‡Æ≥‡Øç ‡ÆÆ‡ØÇ‡Æ≤‡ÆÆ‡Øç) ‡ÆÖ‡Æ¥‡Æø‡Æï‡Øç‡Æï‡Æï‡Øç‡Æï‡ØÇ‡Æü‡Æø‡ÆØ ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æ≥‡Øç‡Æï‡Æ≥‡Øç ‡ÆÜ‡Æï‡ØÅ‡ÆÆ‡Øç. ‡Æâ‡Æ§‡Ææ‡Æ∞‡Æ£‡ÆÆ‡Øç: ‡ÆÜ‡Æ™‡Øç‡Æ™‡Æø‡Æ≥‡Øç, ‡Æµ‡Ææ‡Æ¥‡Øà ‡Æ™‡Æ¥‡ÆÆ‡Øç.')
        st.subheader('‡Æé‡Æ©‡Øç‡Æ© ‡Æá‡Æ§‡ØÅ ‚Äì ‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç ‡Æö‡Ææ‡Æ∞‡Ææ ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ?')
        st.write('‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç ‡Æö‡Ææ‡Æ∞‡Ææ ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡ØÅ ‡Æá‡ÆØ‡Æ±‡Øç‡Æï‡Øà‡ÆØ‡Ææ‡Æï ‡ÆÖ‡Æ¥‡Æø‡Æï‡Øç‡Æï ‡ÆÆ‡ØÅ‡Æü‡Æø‡ÆØ‡Ææ‡Æ§ ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æ≥‡Øç‡Æï‡Æ≥‡Øç. ‡Æâ‡Æ§‡Ææ‡Æ∞‡Æ£‡ÆÆ‡Øç: ‡Æ™‡Æø‡Æ≥‡Ææ‡Æ∏‡Øç‡Æü‡Æø‡Æï‡Øç ‡ÆÆ‡ØÇ‡Æü‡Æø, ‡Æï‡Æ£‡Øç‡Æ£‡Ææ‡Æü‡Æø.')
        st.subheader('CNN ‡Æé‡Æ©‡Øç‡Æ±‡Ææ‡Æ≤‡Øç ‡Æé‡Æ©‡Øç‡Æ©?')
        st.write('‡Æï‡Æ£‡Æø‡Æ©‡Æø ‡Æï‡Ææ‡Æü‡Øç‡Æö‡Æø ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Ææ‡Æü‡ØÅ‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡ÆÆ‡Øç ‡Æí‡Æ∞‡ØÅ ‡Æµ‡Æï‡Øà ‡ÆÜ‡Æ¥‡ÆÆ‡Ææ‡Æ© ‡Æ®‡Æ∞‡ÆÆ‡Øç‡Æ™‡Æø‡ÆØ‡Æ≤‡Øç ‡Æµ‡Æ≤‡Øà‡Æ™‡Øç‡Æ™‡Æø‡Æ©‡Øç‡Æ©‡Æ≤‡Øç.')
        st.subheader('Machine Learning ‡Æé‡Æ©‡Øç‡Æ±‡Ææ‡Æ≤‡Øç ‡Æé‡Æ©‡Øç‡Æ©?')
        st.write('‡Æ§‡Æï‡Æµ‡Æ≤‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ ‡Æï‡Æ±‡Øç‡Æ±‡ØÅ‡Æï‡Øç‡Æï‡Øä‡Æ≥‡Øç‡Æµ‡Æ§‡Æ±‡Øç‡Æï‡Ææ‡Æ© ‡Æö‡ØÜ‡ÆØ‡Æ±‡Øç‡Æï‡Øà ‡Æ®‡ØÅ‡Æ£‡Øç‡Æ£‡Æ±‡Æø‡Æµ‡Æø‡Æ©‡Øç ‡Æí‡Æ∞‡ØÅ ‡Æï‡Æø‡Æ≥‡Øà.')
        st.subheader('Streamlit ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡ØÅ ‡Æé‡Æ©‡Øç‡Æ©?')
        st.write('‡Æ™‡Øà‡Æ§‡Ææ‡Æ©‡Øç ‡Æöcrip‡Øç‡Æü‡ØÅ‡Æï‡Æ≥‡Øà ‡Æé‡Æ≥‡Æø‡Æ§‡Æø‡Æ≤‡Øç ‡Æá‡Æ£‡Øà‡ÆØ ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Æø‡Æï‡Æ≥‡Ææ‡Æï ‡ÆÆ‡Ææ‡Æ±‡Øç‡Æ± ‡Æâ‡Æ§‡Æµ‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡ÆÆ‡Øà‡Æ™‡Øç‡Æ™‡ØÅ.')
        st.subheader('YOLOv8 ‡Æé‡Æ©‡Øç‡Æ±‡Ææ‡Æ≤‡Øç ‡Æé‡Æ©‡Øç‡Æ©?')
        st.write('YOLOv8 ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡ØÅ ‡Æ™‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æµ‡ØÄ‡Æü‡Æø‡ÆØ‡Øã‡Æï‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æ≥‡Øç‡Æï‡Æ≥‡Øà ‡ÆÖ‡Æü‡Øà‡ÆØ‡Ææ‡Æ≥‡ÆÆ‡Øç ‡Æï‡Ææ‡Æ£‡ØÅ‡ÆÆ‡Øç ‡Æï‡Æ£‡Æø‡Æ©‡Æø ‡Æ§‡Æø‡Æü‡Øç‡Æü‡ÆÆ‡Ææ‡Æï‡ØÅ‡ÆÆ‡Øç. "You Only Look Once" ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡ØÅ ‡ÆÖ‡Æ§‡Æ±‡Øç‡Æï‡ØÅ ‡ÆÖ‡Æ∞‡Øç‡Æ§‡Øç‡Æ§‡ÆÆ‡Øç.')

    a, b = st.tabs(['‡ÆÆ‡ØÅ‡Æï‡Æ™‡Øç‡Æ™‡ØÅ', '‡Æï‡Ææ‡Æ£‡Øç‡Æ™‡Æø‡Æ§‡Øç‡Æ§‡Æ≤‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà'])

    with b:
        st.title("üì∑ ‡Æ™‡Æü‡ÆÆ‡Øç ‡Æâ‡Æ≥‡Øç‡Æ≥‡ØÄ‡Æü‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Æø")
        st.markdown("""
        **‡Æ™‡Æü‡Æ§‡Øç‡Æ§‡Øà ‡Æé‡Æ™‡Øç‡Æ™‡Æü‡Æø‡Æ™‡Øç ‡Æ™‡ØÜ‡Æ± ‡Æµ‡Æø‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡ØÅ‡Æï‡Æø‡Æ±‡ØÄ‡Æ∞‡Øç‡Æï‡Æ≥‡Øç ‡Æé‡Æ©‡Øç‡Æ™‡Æ§‡Øà‡Æ§‡Øç ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç:**
        - **‡Æ™‡Æü‡Æ§‡Øç‡Æ§‡Øà ‡Æ™‡Æ§‡Æø‡Æµ‡Øá‡Æ±‡Øç‡Æ±‡ØÅ** ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æö‡Ææ‡Æ§‡Æ©‡Æ§‡Øç‡Æ§‡Æø‡Æ≤‡Øç ‡Æá‡Æ∞‡ØÅ‡Æ®‡Øç‡Æ§‡ØÅ ‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï.
        - **‡Æ™‡ØÅ‡Æï‡Øà‡Æ™‡Øç‡Æ™‡Æü‡ÆÆ‡Øç ‡Æé‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç** ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æï‡Ææ‡ÆÆ‡ØÜ‡Æ∞‡Ææ‡Æµ‡Øà‡Æ™‡Øç ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æø.
        """)

        if 'mode' not in st.session_state:
            st.session_state.mode = None
        if 'image' not in st.session_state:
            st.session_state.image = None

        col1, col2 = st.columns(2)
        with col1:
            if st.button("‡Æ™‡Æü‡Æ§‡Øç‡Æ§‡Øà ‡Æ™‡Æ§‡Æø‡Æµ‡Øá‡Æ±‡Øç‡Æ±‡ØÅ üìÅ"):
                st.session_state.mode = 'upload'
        with col2:
            if st.button("‡Æ™‡ØÅ‡Æï‡Øà‡Æ™‡Øç‡Æ™‡Æü‡ÆÆ‡Øç ‡Æé‡Æü‡ØÅ üì∑"):
                st.session_state.mode = 'capture'

        if st.session_state.mode == 'upload':
            uploaded_file = st.file_uploader("‡Æ™‡Æü‡Æ§‡Øç‡Æ§‡Øà ‡Æ§‡Øá‡Æ∞‡Øç‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ‡Æµ‡ØÅ‡ÆÆ‡Øç", type=["png", "jpg", "jpeg"])
            if uploaded_file is not None:
                st.session_state.image = Image.open(uploaded_file)
        elif st.session_state.mode == 'capture':
            camera_image = st.camera_input("‡Æ™‡ØÅ‡Æï‡Øà‡Æ™‡Øç‡Æ™‡Æü‡ÆÆ‡Øç ‡Æé‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç")
            if camera_image is not None:
                st.session_state.image = Image.open(camera_image)

        if st.session_state.image is not None:
            st.subheader("‡Æ§‡Øá‡Æ∞‡Øç‡Æ®‡Øç‡Æ§‡ØÜ‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ™‡Æü‡ÆÆ‡Øç")
            st.image(st.session_state.image, caption="‡Æ®‡ØÄ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Æ¥‡Æô‡Øç‡Æï‡Æø‡ÆØ ‡Æ™‡Æü‡ÆÆ‡Øç", use_container_width=True)

            if st.button("üîç ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æ≥‡Øç‡Æï‡Æ≥‡Øà ‡Æï‡Æ£‡Øç‡Æü‡Æ±‡Æø"):
                st.subheader("YOLOv8 ‡Æï‡Æ£‡Øç‡Æü‡Æ±‡Æø‡Æ§‡Æ≤‡Øç ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç")
                image_bytes = io.BytesIO()
                image_rgb = st.session_state.image.convert("RGB")
                image_rgb.save(image_bytes, format='JPEG')

                image_bytes.seek(0)
                
                response = requests.post(
                    "https://fast-api-backend-8g48.onrender.com/predict",  # ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç FastAPI URL
                    files={"file": ("image.jpg", image_bytes, "image/jpeg")},
                )
                boxes = []
                if response.status_code == 200:
                    result = response.json()
                    boxes = result.get("results", [])
                    
                    img = np.array(st.session_state.image.convert("RGB"))
                    for box in boxes:
                        x1, y1, x2, y2 = map(int, [box["x1"], box["y1"], box["x2"], box["y2"]])
                        label = box["label"]
                        conf = float(box["confidence"])
                        cv2.rectangle(img, (x1, y1), (x2, y2), (0, 255, 0), 2)
                        cv2.putText(img, f"{label} {conf:.2%}", (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.6, (255, 255, 255), 2)

                    st.image(img, caption="‡Æï‡Æ£‡Øç‡Æü‡Æ±‡Æø‡ÆØ‡Æ™‡Øç‡Æ™‡Æü‡Øç‡Æü ‡Æ™‡Øä‡Æ∞‡ØÅ‡Æü‡Øç‡Æï‡Æ≥‡Øç", use_container_width=True)
                else:
                    st.error(f"‚ùå ‡Æö‡Øá‡Æµ‡Øà‡ÆØ‡Æï‡Æ§‡Øç‡Æ§‡Æø‡Æ©‡Øç ‡Æ™‡Æø‡Æ¥‡Øà: {response.status_code}")
                    st.text(response.text)

                biodegradable = {'apple', 'banana'}
                non_biodegradable = {'plastic', 'glass'}
                
                detected_labels = set()
                confidence_map = {}
                
                if boxes:
                    for box in boxes:
                        label = box["label"]
                        conf = float(box["confidence"])
                        detected_labels.add(label)
                        confidence_map[label] = f"{conf:.2%}"

                    st.subheader("‚ôªÔ∏è ‡Æï‡Æ¥‡Æø‡Æµ‡Æø‡Æ©‡Øç ‡Æµ‡Æï‡Øà ‡Æµ‡Æï‡Øà‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æ≤‡Øç")
                    waste_type = None
                    if detected_labels & biodegradable and not detected_labels & non_biodegradable:
                        st.success("‡Æá‡Æ§‡ØÅ ‡Æí‡Æ∞‡ØÅ **‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡ØÅ‡Æö‡Øç‡Æö‡Øá‡Æ∞‡Æø‡ÆØ‡Æï‡Øç‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ**.")
                        st.audio("biodegradable.mp3", format="audio/mp3")
                        waste_type = "Biodegradable"
                    elif detected_labels & non_biodegradable and not detected_labels & biodegradable:
                        st.error("‡Æá‡Æ§‡ØÅ ‡Æí‡Æ∞‡ØÅ **‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç ‡Æö‡Ææ‡Æ∞‡Ææ ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ**.")
                        st.audio("non-biodegradable.mp3", format="audio/mp3")
                        waste_type = "Non-Biodegradable"
                    elif detected_labels & biodegradable and detected_labels & non_biodegradable:
                        st.info("‡Æá‡Æ§‡ØÅ **‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡ØÅ‡Æö‡Øç‡Æö‡Øá‡Æ∞‡Æø ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç ‡Æö‡Ææ‡Æ∞‡Ææ** ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øà ‡Æâ‡Æ≥‡Øç‡Æ≥‡Æü‡Æï‡Øç‡Æï‡Æø‡ÆØ‡Æ§‡ØÅ.")
                        waste_type = "Mixed"
                    else:
                        st.warning("‡Æé‡Æ®‡Øç‡Æ§ ‡Æµ‡Æï‡Øà ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æü‡Øà‡ÆØ‡Ææ‡Æ≥‡ÆÆ‡Øç ‡Æï‡Ææ‡Æ£‡Æ™‡Øç‡Æ™‡Æü‡Æµ‡Æø‡Æ≤‡Øç‡Æ≤‡Øà.")

                    if waste_type in ["Biodegradable", "Non-Biodegradable"]:
                        pdf = FPDF()
                        pdf.add_page()
                        pdf.set_font("Arial", size=12)

                        pdf.set_title("Waste Detection Report")
                        pdf.cell(200, 10, txt="Waste Detection Report", ln=True, align='C')
                        pdf.ln(10)

                        pdf.cell(200, 10, txt=f"Waste Type Detected: {waste_type}", ln=True)
                        pdf.ln(5)

                        if waste_type == "Biodegradable":
                            pdf.multi_cell(0, 10, txt=(
                                "The CNN model based on deep learning accuracy: 90%\n"
                                "Yolov8 model accuracy: about 85%\n"
                                "Biodegradable waste such as apple and banana can naturally decompose.\n\n"
                                " Disposal Recommendation:\n"
                                "- Discard in green bins.\n"
                                "- Compost at home if possible.\n"
                                "- Do not mix with plastic or glass waste.\n\n"
                                " Environmental Measures:\n"
                                "- Promote organic composting.\n"
                                "- Keep surroundings clean.\n"
                                "- Educate others on separating biodegradable waste."
                            ))
                        else:
                            pdf.multi_cell(0, 10, txt=(
                                "The CNN model based on deep learning accuracy: 90%\n"
                                "Yolov8 model accuracy: about 85%\n"
                                "Non-biodegradable waste such as plastic and glass cannot decompose naturally.\n\n"
                                " Disposal Recommendation:\n"
                                "- Discard in blue bins or recycling centers.\n"
                                "- Never burn plastic waste.\n\n"
                                " Environmental Measures:\n"
                                "- Reduce plastic usage.\n"
                                "- Support recycling initiatives.\n"
                                "- Keep public areas free of litter."
                            ))

                        pdf_output = io.BytesIO()
                        pdf_bytes = pdf.output(dest='S').encode('latin-1')
                        pdf_output.write(pdf_bytes)
                        pdf_output.seek(0)

                        st.download_button(
                            label="üìÑ ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ ‡ÆÖ‡Æ±‡Æø‡Æï‡Øç‡Æï‡Øà‡ÆØ‡Øà PDF ‡ÆÜ‡Æï ‡Æ™‡Æ§‡Æø‡Æµ‡Æø‡Æ±‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç",
                            data=pdf_output,
                            file_name="waste_report.pdf",
                            mime="application/pdf"
                        )

        st.divider()

    with a:
        st.write("## üåç ‡Æè‡Æ©‡Øç ‡Æá‡Æ§‡ØÅ ‡ÆÆ‡ØÅ‡Æï‡Øç‡Æï‡Æø‡ÆØ‡ÆÆ‡Øç?")
        st.write("‡Æ®‡Ææ‡ÆÆ‡Øç ‡Æ§‡Æø‡Æ©‡ÆÆ‡ØÅ‡ÆÆ‡Øç ‡Æâ‡Æ∞‡ØÅ‡Æµ‡Ææ‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æ™‡ØÜ‡Æ∞‡ØÅ‡ÆÆ‡Øç‡Æ™‡Ææ‡Æ©‡Øç‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ©‡Æµ‡Øà ‡Æ§‡Æµ‡Æ±‡Ææ‡Æ© ‡Æá‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æï‡Æø‡Æü‡Æ™‡Øç‡Æ™‡Æ§‡Ææ‡Æ≤‡Øç ‡Æö‡ØÅ‡Æ±‡Øç‡Æ±‡ØÅ‡Æö‡Øç‡Æö‡ØÇ‡Æ¥‡Æ≤‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡Æ§‡ØÄ‡Æô‡Øç‡Æï‡ØÅ ‡Æµ‡Æø‡Æ≥‡Øà‡Æµ‡Æø‡Æï‡Øç‡Æï‡Æø‡Æ©‡Øç‡Æ±‡Æ©.")
        st.write("- ‡Æö‡ØÅ‡Æ±‡Øç‡Æ±‡ØÅ‡Æö‡Øç‡Æö‡ØÇ‡Æ¥‡Æ≤‡Øç ‡ÆÆ‡Ææ‡Æö‡ØÅ‡Æ™‡Ææ‡Æü‡Øç‡Æü‡Øà ‡Æï‡ØÅ‡Æ±‡Øà‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç")  
        st.write("- ‡ÆÆ‡Æ±‡ØÅ‡Æö‡ØÅ‡Æ¥‡Æ±‡Øç‡Æö‡Æø ‡Æ§‡Æø‡Æ±‡Æ©‡Øà ‡ÆÖ‡Æ§‡Æø‡Æï‡Æ∞‡Æø‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç")  
        st.write("- ‡Æö‡ØÅ‡Æ§‡Øç‡Æ§‡ÆÆ‡Ææ‡Æ© ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Æö‡ØÅ‡ÆÆ‡Øà‡ÆØ‡Ææ‡Æ© ‡Æé‡Æ§‡Æø‡Æ∞‡Øç‡Æï‡Ææ‡Æ≤‡Æ§‡Øç‡Æ§‡Øà ‡Æâ‡Æ∞‡ØÅ‡Æµ‡Ææ‡Æï‡Øç‡Æï‡ØÅ‡ÆÆ‡Øç")
        st.write("‡Æá‡Æ®‡Øç‡Æ§ ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Æø **‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡ØÅ‡Æö‡Øç‡Æö‡Øá‡Æ∞‡Æø ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç ‡Æö‡Ææ‡Æ∞‡Ææ ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øà** ‡ÆÖ‡Æü‡Øà‡ÆØ‡Ææ‡Æ≥‡ÆÆ‡Øç ‡Æï‡Ææ‡Æ£‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ, ‡ÆÆ‡Øá‡Æ≤‡ØÅ‡ÆÆ‡Øç ‡Æï‡Øà‡ÆØ‡Ææ‡Æ≥‡ØÅ‡Æµ‡Æ§‡Æø‡Æ≤‡Øç ‡Æâ‡Æ§‡Æµ‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ.")
        st.write('---')
        st.write('#### ‡Æ™‡Æü‡ÆÆ‡Øä‡Æ©‡Øç‡Æ±‡Øà ‡Æ™‡Æ§‡Æø‡Æµ‡Øá‡Æ±‡Øç‡Æ±‡Æµ‡ØÅ‡ÆÆ‡Øç ‡ÆÖ‡Æ≤‡Øç‡Æ≤‡Æ§‡ØÅ ‡Æé‡Æü‡ØÅ‡Æï‡Øç‡Æï‡Æµ‡ØÅ‡ÆÆ‡Øç ‚Äî ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æµ‡Øá‡Æ≤‡Øà ‡ÆÆ‡ØÅ‡Æü‡Æø‡Æ®‡Øç‡Æ§‡Æ§‡ØÅ!')
        st.write('---')
        st.write("### üß† ‡Æá‡Æ§‡ØÅ ‡Æé‡Æ™‡Øç‡Æ™‡Æü‡Æø‡Æö‡Øç ‡Æö‡ØÜ‡ÆØ‡Æ≤‡Øç‡Æ™‡Æü‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ?")
        st.write("‡Æá‡ÆØ‡Æ®‡Øç‡Æ§‡Æø‡Æ∞‡Æï‡Øç ‡Æï‡Æ±‡Øç‡Æ±‡Æ≤‡Øç ‡ÆÆ‡Æ±‡Øç‡Æ±‡ØÅ‡ÆÆ‡Øç ‡Æ™‡Æü‡ÆÆ‡Øç ‡Æ™‡Æï‡ØÅ‡Æ™‡Øç‡Æ™‡Ææ‡ÆØ‡Øç‡Æµ‡Øà‡Æ™‡Øç ‡Æ™‡ÆØ‡Æ©‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡Æø, ‡Æá‡Æ®‡Øç‡Æ§ ‡ÆÆ‡ØÅ‡Æ±‡Øà ‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡Æü‡Æô‡Øç‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æâ‡Æ≥‡Øç‡Æ≥ ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øà ‡Æá‡Æ∞‡Æ£‡Øç‡Æü‡ØÅ ‡Æµ‡Æï‡Øà‡Æï‡Æ≥‡Æø‡Æ≤‡Øç ‡Æµ‡Æï‡Øà‡Æ™‡Øç‡Æ™‡Æü‡ØÅ‡Æ§‡Øç‡Æ§‡ØÅ‡Æï‡Æø‡Æ±‡Æ§‡ØÅ:")
        st.markdown("- **‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç‡Æ™‡ØÅ‡Æö‡Øç‡Æö‡Øá‡Æ∞‡Æø** ‚Äì ‡Æá‡ÆØ‡Æ±‡Øç‡Æï‡Øà ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç: ‡Æ™‡Æ¥‡Æô‡Øç‡Æï‡Æ≥‡Øç (‡ÆÜ‡Æ™‡Øç‡Æ™‡Æø‡Æ≥‡Øç, ‡Æµ‡Ææ‡Æ¥‡Øà‡Æ™‡Øç‡Æ™‡Æ¥‡ÆÆ‡Øç), ‡Æá‡Æ≤‡Øà‡Æï‡Æ≥‡Øç.")
        st.markdown("- **‡Æâ‡ÆØ‡Æø‡Æ∞‡Øç‡Æ™‡Øç ‡Æö‡Ææ‡Æ∞‡Ææ** ‚Äì ‡Æö‡ØÜ‡ÆØ‡Æ±‡Øç‡Æï‡Øà ‡Æï‡Æ¥‡Æø‡Æµ‡ØÅ‡Æï‡Æ≥‡Øç: ‡Æ™‡Æø‡Æ≥‡Ææ‡Æ∏‡Øç‡Æü‡Æø‡Æï‡Øç ‡Æ™‡Ææ‡Æü‡Øç‡Æü‡Æø‡Æ≤‡Øç‡Æï‡Æ≥‡Øç, ‡ÆÆ‡ØÇ‡Æü‡Æø‡Æï‡Æ≥‡Øç.")
    
    


if language == "Malay":
    st.title("Aplikasi Pengelasan Sisa - Kekalkan Alam Sekitar Bersih")

    def predict_image_class(image, model):
        image = image.convert('RGB')
        img = np.array(image)
        img_resized = cv2.resize(img, (256, 256))
        img_normalized = img_resized / 255.0
        img_reshaped = img_normalized.reshape(1, 256, 256, 3)
        prediction = model.predict(img_reshaped)
        predicted_index = np.argmax(prediction)
        predicted_class = class_names[predicted_index]
        return predicted_class

    with st.sidebar:
        st.subheader('Apa itu bahan biodegradasi?')
        st.write('Bahan biodegradasi ialah bahan yang boleh diuraikan secara semula jadi oleh mikroorganisma menjadi unsur seperti air, karbon dioksida, dan bahan organik tanpa mencemarkan alam sekitar. Contoh: Epal, Pisang.')
        st.subheader('Apa itu bahan tidak biodegradasi?')
        st.write('Bahan tidak biodegradasi tidak boleh diuraikan oleh mikroorganisma dan kekal dalam alam sekitar untuk jangka masa yang lama. Contoh: Beg plastik, botol plastik, kaca.')
        st.subheader('Apa itu CNN?')
        st.write('Rangkaian neural mendalam yang digunakan dalam penglihatan komputer untuk mengenal pasti ciri dalam imej secara automatik.')
        st.subheader('Apa itu Pembelajaran Mesin?')
        st.write('Cabang kecerdasan buatan yang membolehkan komputer belajar dari data tanpa diprogramkan secara langsung.')
        st.subheader('Apa itu Streamlit?')
        st.write('Kerangka kerja Python untuk membina aplikasi web interaktif daripada skrip data dengan mudah.')
        st.subheader('Apa itu YOLOv8?')
        st.write('YOLOv8 adalah program komputer yang boleh mengenal pasti objek dalam imej atau video seperti pisang, botol, atau manusia. YOLO bermaksud "You Only Look Once".')

    a, b = st.tabs(['Laman Utama', 'Pengesanan & Laporan'])

    with b:
        st.title("üì∑ Aplikasi Input Imej")
        st.markdown("""
        **Pilih cara untuk memuatkan imej:**
        - **Muat Naik Imej** dari peranti anda.
        - **Ambil Gambar** menggunakan kamera web anda.
        """)

        if 'mode' not in st.session_state:
            st.session_state.mode = None
        if 'image' not in st.session_state:
            st.session_state.image = None

        col1, col2 = st.columns(2)
        with col1:
            if st.button("Muat Naik Imej üìÅ"):
                st.session_state.mode = 'upload'
        with col2:
            if st.button("Ambil Gambar üì∑"):
                st.session_state.mode = 'capture'

        if st.session_state.mode == 'upload':
            uploaded_file = st.file_uploader("Pilih fail imej", type=["png", "jpg", "jpeg"])
            if uploaded_file is not None:
                st.session_state.image = Image.open(uploaded_file)
        elif st.session_state.mode == 'capture':
            camera_image = st.camera_input("Ambil gambar")
            if camera_image is not None:
                st.session_state.image = Image.open(camera_image)

        if st.session_state.image is not None:
            st.subheader("Imej Dipilih")
            st.image(st.session_state.image, caption="Inilah imej yang anda berikan", use_container_width=True)

            if st.button("üîç Kesan Objek"):
                st.subheader("Keputusan Pengesanan YOLOv8")
                image_bytes = io.BytesIO()
                image_rgb = st.session_state.image.convert("RGB")
                image_rgb.save(image_bytes, format='JPEG')

                image_bytes.seek(0)

                response = requests.post(
                    "https://fast-api-backend-8g48.onrender.com/predict",
                    files={"file": ("image.jpg", image_bytes, "image/jpeg")},
                )
                boxes = []
                if response.status_code == 200:
                    result = response.json()
                    boxes = result.get("results", [])

                    img = np.array(st.session_state.image.convert("RGB"))
                    for box in boxes:
                        x1, y1, x2, y2 = map(int, [box["x1"], box["y1"], box["x2"], box["y2"]])
                        label = box["label"]
                        conf = float(box["confidence"])
                        cv2.rectangle(img, (x1, y1), (x2, y2), (0, 255, 0), 2)
                        cv2.putText(img, f"{label} {conf:.2%}", (x1, y1 - 10), cv2.FONT_HERSHEY_SIMPLEX, 0.6, (255, 255, 255), 2)

                    st.image(img, caption="Objek Dikenal Pasti", use_container_width=True)
                else:
                    st.error(f"‚ùå Ralat dari pelayan pengesanan: {response.status_code}")
                    st.text(response.text)

                biodegradable = {'apple', 'banana'}
                non_biodegradable = {'plastic', 'glass'}

                detected_labels = set()
                confidence_map = {}

                if boxes:
                    for box in boxes:
                        label = box["label"]
                        conf = float(box["confidence"])
                        detected_labels.add(label)
                        confidence_map[label] = f"{conf:.2%}"

                    st.subheader("‚ôªÔ∏è Pengelasan Jenis Sisa")
                    waste_type = None
                    if detected_labels & biodegradable and not detected_labels & non_biodegradable:
                        st.success("Sisa ini adalah **Biodegradasi**.")
                        st.audio("biodegradable.mp3", format="audio/mp3")
                        waste_type = "Biodegradable"
                    elif detected_labels & non_biodegradable and not detected_labels & biodegradable:
                        st.error("Sisa ini adalah **Tidak Biodegradasi**.")
                        st.audio("non-biodegradable.mp3", format="audio/mp3")
                        waste_type = "Non-Biodegradable"
                    elif detected_labels & biodegradable and detected_labels & non_biodegradable:
                        st.info("Sisa ini mengandungi **Biodegradasi dan Tidak Biodegradasi**.")
                        waste_type = "Mixed"
                    else:
                        st.warning("Tiada jenis sisa dapat dikenalpasti.")

                    if waste_type in ["Biodegradable", "Non-Biodegradable"]:
                        pdf = FPDF()
                        pdf.add_page()
                        pdf.set_font("Arial", size=12)

                        pdf.set_title("Laporan Pengesanan Sisa")
                        pdf.cell(200, 10, txt="Laporan Pengesanan Sisa", ln=True, align='C')
                        pdf.ln(10)

                        pdf.cell(200, 10, txt=f"Jenis Sisa Dikesan: {waste_type}", ln=True)
                        pdf.ln(5)

                        if waste_type == "Biodegradable":
                            pdf.multi_cell(0, 10, txt=(
                                "Ketepatan model CNN berdasarkan pembelajaran mendalam: 90%\n"
                                "Ketepatan model YOLOv8: sekitar 85%\n"
                                "Sisa biodegradasi seperti epal dan pisang boleh terurai secara semula jadi.\n\n"
                                " Cadangan Pelupusan:\n"
                                "- Buang dalam tong hijau.\n"
                                "- Kompos di rumah jika boleh.\n"
                                "- Elakkan mencampur dengan plastik atau kaca.\n\n"
                                " Langkah Alam Sekitar:\n"
                                "- Galakkan kompos organik.\n"
                                "- Kekalkan kebersihan sekitar.\n"
                                "- Didik masyarakat tentang pengasingan sisa."
                            ))
                        else:
                            pdf.multi_cell(0, 10, txt=(
                                "Ketepatan model CNN berdasarkan pembelajaran mendalam: 90%\n"
                                "Ketepatan model YOLOv8: sekitar 85%\n"
                                "Sisa tidak biodegradasi seperti plastik dan kaca tidak boleh terurai secara semula jadi.\n\n"
                                " Cadangan Pelupusan:\n"
                                "- Buang dalam tong biru atau pusat kitar semula.\n"
                                "- Jangan sekali-kali membakar sisa plastik.\n\n"
                                " Langkah Alam Sekitar:\n"
                                "- Kurangkan penggunaan plastik.\n"
                                "- Sokong inisiatif kitar semula.\n"
                                "- Pastikan kawasan awam bebas sampah."
                            ))

                        pdf_output = io.BytesIO()
                        pdf_bytes = pdf.output(dest='S').encode('latin-1')
                        pdf_output.write(pdf_bytes)
                        pdf_output.seek(0)

                        st.download_button(
                            label="üìÑ Muat Turun Laporan Sisa (PDF)",
                            data=pdf_output,
                            file_name="laporan_sisa.pdf",
                            mime="application/pdf"
                        )

        st.divider()

    with a:
        st.write("## üåç Kenapa Ia Penting?")
        st.write("Setiap hari kita menghasilkan sisa. Jika tidak diurus dengan betul, ia boleh mencemarkan alam sekitar.")
        st.write("- Mengurangkan pencemaran")  
        st.write("- Meningkatkan keberkesanan kitar semula")  
        st.write("- Menyokong masa depan yang bersih dan hijau")
        st.write("Sistem kami dapat **membezakan antara bahan biodegradasi dan tidak biodegradasi**, menjadikan pelupusan lebih pintar.")
        st.write('---')
        st.write('#### Hanya muat naik atau ambil gambar ‚Äî sistem akan mengurus selebihnya!')
        st.write('---')
        st.write("### üß† Bagaimana Ia Berfungsi?")
        st.write("Menggunakan pembelajaran mesin dan pemprosesan imej, model kami menganalisis imej sisa dan mengelaskannya kepada dua kategori:")
        st.markdown("- **Biodegradasi** ‚Äì Sisa semula jadi seperti buah-buahan, daun, dll.")
        st.markdown("- **Tidak Biodegradasi** ‚Äì Sisa buatan seperti botol plastik, pembungkus, dll.")

    
    
    
    
